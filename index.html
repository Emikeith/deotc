<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winnipeg EOTC Portal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="logo-container"><img src="logo.png" alt="Logo" onerror="this.src='https://via.placeholder.com/80'"></div>
    <h1 style="margin:0; font-size: 1.2rem;">የኢትዮጵያ ኦርቶዶክስ ተዋሕዶ ቤተክርስቲያን</h1>
    <p style="color:var(--gold); font-weight:bold; margin:5px 0;">ETHIOPIAN ORTHODOX TEWAHEDO CHURCH</p>
</header>

<div class="ticker-bar">
    <div class="ticker-label">NEWS</div>
    <div class="ticker-wrap"><div id="ticker-content" class="ticker-text"></div></div>
</div>

<nav>
    <button class="menu-toggle" onclick="mainMenuToggle()">☰ MENU / ማውጫ</button>
    <ul class="menu-container" id="main-nav-ul">
        <li class="nav-item">
            <a class="nav-link" onclick="subMenuToggle(this)">Home</a>
            <div class="dropdown">
                <a onclick="goTo('home-main')">Main Home</a>
                <a onclick="goTo('about-us')">About Us</a>
            </div>
        </li>
        <li class="nav-item">
            <a class="nav-link" onclick="subMenuToggle(this)">Ministries</a>
            <div class="dropdown">
                <a onclick="goTo('min-ss')">Sunday School</a>
                <a onclick="goTo('reg-page')">Registrations</a>
            </div>
        </li>
        <li class="nav-item"><a class="nav-link" onclick="goTo('pay-page')">Donations</a></li>
    </ul>
</nav>

<section id="home-main" class="page active">
    <div class="card" style="text-align:center; border:2px solid var(--gold);">
        <div id="g-date" style="font-size: 0.9rem; color: #777;"></div>
        <div id="e-date" style="font-size: 1.5rem; color: var(--red); font-weight: bold; margin-top:5px;"></div>
    </div>
    <div class="card">
        <h2 id="proj-title" style="color:var(--red);"></h2>
        <p id="proj-desc"></p>
        <div class="progress-bg"><div id="proj-progress" class="progress-fill"></div></div>
        <div id="building-gallery" class="gallery-grid"></div>
    </div>
</section>

<section id="min-ss" class="page">
    <div class="card">
        <div id="ss-posts-container"></div>
    </div>
</section>

<section id="about-us" class="page"><div class="card"><h2>About Us</h2><p id="txt-about"></p></div></section>

<section id="reg-page" class="page">
    <div class="card">
        <h2>Registrations / ምዝገባ</h2>
        <div style="display:grid; gap:10px;">
            <a id="l-mem" href="#" target="_blank" class="nav-link" style="border:1px solid #ddd; border-radius:8px;">Church Membership</a>
            <a id="l-ss" href="#" target="_blank" class="nav-link" style="border:1px solid #ddd; border-radius:8px;">Sunday School</a>
        </div>
    </div>
</section>

<section id="pay-page" class="page"><div class="card" style="text-align:center;"><h2>Donations</h2><p id="txt-zelle" style="font-weight:bold;"></p></div></section>

<div id="gallery-modal" onclick="this.style.display='none'"><img id="modal-img"></div>

<script src="content.js"></script>
<script>
    function mainMenuToggle() { document.getElementById('main-nav-ul').classList.toggle('active-menu'); }
    function subMenuToggle(el) { if(window.innerWidth <= 800) el.parentElement.classList.toggle('open-submenu'); }
    function goTo(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('main-nav-ul').classList.remove('active-menu');
        window.scrollTo(0,0);
    }

    function getEthiopianDate() {
        const now = new Date();
        const ethiopianMonths = ["መስከረም", "ጥቅምት", "ኅዳር", "ታኅሣሥ", "ጥር", "የካቲት", "መጋቢት", "ሚያዝያ", "ግንቦት", "ሰኔ", "ሐምሌ", "ነሐሴ", "ጳጉሜ"];
        let eDay = now.getDate() - 8; 
        if (eDay <= 0) eDay += 30;
        return `${ethiopianMonths[4]} ${eDay}, ${now.getFullYear() - 8} ዓ.ም`;
    }

    function openLightbox(url) {
        document.getElementById('modal-img').src = url;
        document.getElementById('gallery-modal').style.display = 'flex';
    }

    function render() {
        const d = ChurchData;
        
        // News Ticker
        document.getElementById('ticker-content').innerHTML = d.newsTicker;

        // Date
        document.getElementById('g-date').innerText = new Date().toDateString();
        document.getElementById('e-date').innerText = getEthiopianDate();
        
        // Home
        document.getElementById('proj-title').innerText = d.buildingProject.title;
        document.getElementById('proj-desc').innerText = d.buildingProject.description;
        document.getElementById('proj-progress').style.width = d.buildingProject.progress;
        document.getElementById('proj-progress').innerText = d.buildingProject.progress;

        document.getElementById('building-gallery').innerHTML = d.buildingGallery.map(img => `
            <div class="gallery-item" onclick="openLightbox('${img.url}')"><img src="${img.url}"></div>
        `).join('');

        // Sunday School Side-by-Side Posts
        document.getElementById('ss-posts-container').innerHTML = d.sundaySchoolPosts.map(post => `
            <div class="post-section">
                <div class="post-content">
                    <h2>${post.title}</h2>
                    <p style="line-height:1.6;">${post.text}</p>
                </div>
                <div class="post-media">
                    <img src="${post.image}" alt="Sunday School Post">
                </div>
            </div>
        `).join('');

        // About & Links
        document.getElementById('txt-about').innerText = d.aboutUs;
        document.getElementById('l-mem').href = d.registrationLinks.membership;
        document.getElementById('l-ss').href = d.registrationLinks.sundaySchool;
        document.getElementById('txt-zelle').innerText = "Zelle: " + d.donations.zelle;
    }

    window.onload = render;
</script>
</body>
</html>
